<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenArcade — Play Games, Train AI</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='12' fill='%23ff6b35'/><text x='50' y='70' font-size='55' font-family='Arial,sans-serif' font-weight='bold' fill='white' text-anchor='middle'>A</text></svg>">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="landing">
    <h1>ARCADE</h1>
    <p class="subtitle">Play games. Generate training data. Teach AI to see.</p>

    <div class="live-stats" id="liveStats">
      <div class="live-stat">
        <span class="pulse-dot"></span>
        <span class="live-value" id="onlineCount">--</span>
        <span class="live-label">online</span>
      </div>
      <span class="live-sep">&middot;</span>
      <div class="live-stat">
        <span class="live-value" id="totalHours">--</span>
        <span class="live-label">hours played</span>
      </div>
      <span class="live-sep">&middot;</span>
      <div class="live-stat">
        <span class="live-value" id="totalData">--</span>
        <span class="live-label">training data</span>
      </div>
    </div>

    <div class="mission-bar" id="missionBar">
      <div class="mission-content">
        <p class="mission-text">Your gameplay trains a neural network to play games from raw pixels. We capture screen frames + keyboard inputs and feed them into a vision model.</p>
        <a href="https://ssd.digitalsurface.com" target="_blank" rel="noopener" class="dashboard-link">Watch the AI train live &rarr;</a>
      </div>
      <div class="mission-stats" id="missionStats">
        <div class="stat">
          <span class="stat-value" id="statSessions">--</span>
          <span class="stat-label">sessions</span>
        </div>
        <div class="stat">
          <span class="stat-value" id="statFrames">--</span>
          <span class="stat-label">frames</span>
        </div>
        <div class="stat">
          <span class="stat-value" id="statData">--</span>
          <span class="stat-label">collected</span>
        </div>
      </div>
    </div>

    <div class="search-filter-bar" id="searchFilterBar">
      <input type="text" id="searchInput" placeholder="Search games..." autocomplete="off" spellcheck="false">
      <div class="filter-buttons" id="filterButtons">
        <button class="filter-btn active" data-category="all">All</button>
        <button class="filter-btn" data-category="classic">Classic</button>
        <button class="filter-btn" data-category="action">Action</button>
        <button class="filter-btn" data-category="puzzle">Puzzle</button>
        <button class="filter-btn" data-category="casual">Casual</button>
        <button class="filter-btn" data-category="racing">Racing</button>
      </div>
    </div>

    <div class="games-grid">
      <a href="tetris/index.html" class="game-card card-tetris" data-game="tetris">
        <div class="card-header"><h2>Tetris</h2><span class="plays-badge" data-game="tetris"></span></div>
        <p class="description">Stack falling tetrominoes and clear lines. Speed increases as you score. How long can you survive?</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move/rotate, Space to hard drop</p>
      </a>
      <a href="space-invaders/index.html" class="game-card card-invaders" data-game="space-invaders">
        <div class="card-header"><h2>Space Invaders</h2><span class="plays-badge" data-game="space-invaders"></span></div>
        <p class="description">Defend Earth from descending alien waves. Dodge their fire and shoot them down before they reach you.</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space to fire</p>
      </a>
      <a href="flappy/index.html" class="game-card card-flappy" data-game="flappy">
        <div class="card-header"><h2>Flappy Bird</h2><span class="plays-badge" data-game="flappy"></span></div>
        <p class="description">Tap to flap through narrow pipe gaps. One hit and it's over. Simple to learn, hard to master.</p>
        <p class="controls"><span>Controls:</span> Space or Up arrow to flap</p>
      </a>
      <a href="snake/index.html" class="game-card card-snake" data-game="snake">
        <div class="card-header"><h2>Snake</h2><span class="plays-badge" data-game="snake"></span></div>
        <p class="description">Guide the snake to eat food and grow longer. Don't hit the walls or yourself. Speed increases as you grow.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to change direction</p>
      </a>
      <a href="breakout/index.html" class="game-card card-breakout" data-game="breakout">
        <div class="card-header"><h2>Breakout</h2><span class="plays-badge" data-game="breakout"></span></div>
        <p class="description">Smash rows of colorful bricks with a bouncing ball. Angle your shots off the paddle and clear every level.</p>
        <p class="controls"><span>Controls:</span> Left/Right to move paddle</p>
      </a>
      <a href="pong/v2.html" class="game-card card-pong" data-game="pong">
        <div class="card-header"><h2>Pong</h2><span class="plays-badge" data-game="pong"></span></div>
        <p class="description">The original arcade classic. Rally the ball past the CPU opponent. First to 11 wins the match.</p>
        <p class="controls"><span>Controls:</span> Up/Down to move paddle</p>
      </a>
      <a href="asteroids/index.html" class="game-card card-asteroids" data-game="asteroids">
        <div class="card-header"><h2>Asteroids</h2><span class="plays-badge" data-game="asteroids"></span></div>
        <p class="description">Pilot your ship through a field of tumbling space rocks. Blast them apart and survive the debris.</p>
        <p class="controls"><span>Controls:</span> Left/Right to rotate, Up to thrust, Space to fire</p>
      </a>
      <a href="tron/index.html" class="game-card card-tron" data-game="tron">
        <div class="card-header"><h2>Tron</h2><span class="plays-badge" data-game="tron"></span></div>
        <p class="description">Race your light cycle and leave a trail behind you. Outlast the AI opponent without crashing into walls or trails.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to change direction</p>
      </a>
      <a href="2048/index.html" class="game-card card-2048" data-game="2048">
        <div class="card-header"><h2>2048</h2><span class="plays-badge" data-game="2048"></span></div>
        <p class="description">Slide numbered tiles on a 4x4 grid. Matching numbers merge and double. Reach 2048 and keep going for high scores.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to slide tiles</p>
      </a>
      <a href="dino/index.html" class="game-card card-dino" data-game="dino">
        <div class="card-header"><h2>Dino Run</h2><span class="plays-badge" data-game="dino"></span></div>
        <p class="description">Run endlessly through the desert! Jump over cacti and duck under pterodactyls. Speed increases the longer you survive.</p>
        <p class="controls"><span>Controls:</span> Space/Up to jump, Down to duck</p>
      </a>
      <a href="lunar-lander/index.html" class="game-card card-lander" data-game="lunar-lander">
        <div class="card-header"><h2>Lunar Lander</h2><span class="plays-badge" data-game="lunar-lander"></span></div>
        <p class="description">Guide your spacecraft to a safe landing on the lunar surface. Control thrust and rotation to touch down gently on the pad. Too fast and you crash!</p>
        <p class="controls"><span>Controls:</span> Left/Right to rotate, Up to thrust, land gently on the pad</p>
      </a>
      <a href="minesweeper/index.html" class="game-card card-minesweeper" data-game="minesweeper">
        <div class="card-header"><h2>Minesweeper</h2><span class="plays-badge" data-game="minesweeper"></span></div>
        <p class="description">Click to reveal tiles and find all the mines! Numbers tell you how many mines are adjacent. Clear the board to win!</p>
        <p class="controls"><span>Controls:</span> Left-click to reveal, Right-click to flag</p>
      </a>
      <a href="lights-out/index.html" class="game-card card-lightsout" data-game="lights-out">
        <div class="card-header"><h2>Lights Out</h2><span class="plays-badge" data-game="lights-out"></span></div>
        <p class="description">Toggle lights on and off to turn them all off! Clicking a light toggles it and its neighbors. Solve each puzzle in the fewest clicks possible.</p>
        <p class="controls"><span>Controls:</span> Click on lights to toggle them</p>
      </a>
      <a href="helicopter/index.html" class="game-card card-helicopter" data-game="helicopter">
        <div class="card-header"><h2>Helicopter</h2><span class="plays-badge" data-game="helicopter"></span></div>
        <p class="description">Hold to fly up, release to fall down. Navigate through an endless cave that gets narrower and more treacherous. One touch and you crash!</p>
        <p class="controls"><span>Controls:</span> Hold Space or click/hold mouse to ascend</p>
      </a>
      <a href="canabalt/index.html" class="game-card card-canabalt" data-game="canabalt">
        <div class="card-header"><h2>Canabalt</h2><span class="plays-badge" data-game="canabalt"></span></div>
        <p class="description">Sprint across rooftops at breakneck speed! One button to jump. Time your leaps between buildings and dodge obstacles. How far can you run?</p>
        <p class="controls"><span>Controls:</span> Space or Up to jump</p>
      </a>
      <a href="doodle-jump/index.html" class="game-card card-doodlejump" data-game="doodle-jump">
        <div class="card-header"><h2>Doodle Jump</h2><span class="plays-badge" data-game="doodle-jump"></span></div>
        <p class="description">Bounce ever higher on platforms! Land on green, blue, and breakable platforms as you climb. Miss one and it's game over.</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, auto-bounce on platforms</p>
      </a>
      <a href="sokoban/index.html" class="game-card card-sokoban" data-game="sokoban">
        <div class="card-header"><h2>Sokoban</h2><span class="plays-badge" data-game="sokoban"></span></div>
        <p class="description">Push all the boxes onto the target positions! Plan your moves carefully -- you can push boxes but never pull them. Fewest moves wins!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Z to undo, R to reset</p>
      </a>
      <a href="columns/index.html" class="game-card card-columns" data-game="columns">
        <div class="card-header"><h2>Columns</h2><span class="plays-badge" data-game="columns"></span></div>
        <p class="description">Match three or more gems by stacking columns of three. Cycle gem order as they fall to set up combos and chain reactions!</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Up to cycle, Down to drop</p>
      </a>
      <a href="nibbler/index.html" class="game-card card-nibbler" data-game="nibbler">
        <div class="card-header"><h2>Nibbler</h2><span class="plays-badge" data-game="nibbler"></span></div>
        <p class="description">Guide your ever-growing snake through maze corridors! Eat all the food to advance. Don't crash into walls or yourself!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to change direction</p>
      </a>
      <a href="crossy-road/index.html" class="game-card card-crossy" data-game="crossy-road">
        <div class="card-header"><h2>Crossy Road</h2><span class="plays-badge" data-game="crossy-road"></span></div>
        <p class="description">Hop across busy roads and rivers! Dodge traffic, ride logs, and cross as far as you can. Every row forward scores a point!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to hop and dodge</p>
      </a>
      <a href="kaboom/index.html" class="game-card card-kaboom" data-game="kaboom">
        <div class="card-header"><h2>Kaboom!</h2><span class="plays-badge" data-game="kaboom"></span></div>
        <p class="description">Catch the bombs before they hit the ground! A mad bomber drops bombs faster and faster. Move your buckets to catch them all!</p>
        <p class="controls"><span>Controls:</span> Mouse or Left/Right to move buckets</p>
      </a>
      <a href="air-hockey/index.html" class="game-card card-airhockey" data-game="air-hockey">
        <div class="card-header"><h2>Air Hockey</h2><span class="plays-badge" data-game="air-hockey"></span></div>
        <p class="description">Smack the puck into the opponent's goal! Control your mallet with the mouse and play against the CPU. First to 7 wins!</p>
        <p class="controls"><span>Controls:</span> Mouse to move your mallet</p>
      </a>
      <a href="simon/index.html" class="game-card card-simon" data-game="simon">
        <div class="card-header"><h2>Simon</h2><span class="plays-badge" data-game="simon"></span></div>
        <p class="description">Watch the pattern, then repeat it! Simon shows a sequence of colored lights that grows longer each round. How many can you remember?</p>
        <p class="controls"><span>Controls:</span> Click panels or press 1-4 keys</p>
      </a>
      <a href="duck-hunt/index.html" class="game-card card-duckhunt" data-game="duck-hunt">
        <div class="card-header"><h2>Duck Hunt</h2><span class="plays-badge" data-game="duck-hunt"></span></div>
        <p class="description">Shoot the ducks as they fly across the screen! Click to fire at flying ducks before they escape. Limited shots per round!</p>
        <p class="controls"><span>Controls:</span> Mouse to aim, Click to shoot</p>
      </a>
      <a href="tanks/index.html" class="game-card card-tanks" data-game="tanks">
        <div class="card-header"><h2>Tanks</h2><span class="plays-badge" data-game="tanks"></span></div>
        <p class="description">Aim your cannon and fire at the enemy tank! Adjust angle and power to arc your shot over the terrain. Destroy them first!</p>
        <p class="controls"><span>Controls:</span> Up/Down angle, Left/Right power, Space to fire</p>
      </a>
      <a href="whack-a-mole/index.html" class="game-card card-whackamole" data-game="whack-a-mole">
        <div class="card-header"><h2>Whack-a-Mole</h2><span class="plays-badge" data-game="whack-a-mole"></span></div>
        <p class="description">Smack the moles as they pop up from their holes! Be quick — they don't stay up for long. Watch out for the bonus golden mole!</p>
        <p class="controls"><span>Controls:</span> Click on moles to whack them</p>
      </a>
      <a href="slot-racer/index.html" class="game-card card-slotracer" data-game="slot-racer">
        <div class="card-header"><h2>Slot Racer</h2><span class="plays-badge" data-game="slot-racer"></span></div>
        <p class="description">Race your car around the slot track! Hold to accelerate, release to slow down. Go too fast on curves and you'll fly off!</p>
        <p class="controls"><span>Controls:</span> Hold Space or click to accelerate</p>
      </a>
      <a href="pac-man/index.html" class="game-card card-pacman" data-game="pac-man">
        <div class="card-header"><h2>Pac-Man</h2><span class="plays-badge" data-game="pac-man"></span></div>
        <p class="description">Navigate the maze, eat all the dots, and avoid the ghosts! Grab a power pellet to turn the tables and eat the ghosts.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move</p>
      </a>
      <a href="frogger/index.html" class="game-card card-frogger" data-game="frogger">
        <div class="card-header"><h2>Frogger</h2><span class="plays-badge" data-game="frogger"></span></div>
        <p class="description">Help the frog cross busy roads and a dangerous river! Dodge cars, hop on logs, and reach the lily pads safely.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to hop</p>
      </a>
      <a href="bomberman/index.html" class="game-card card-bomberman" data-game="bomberman">
        <div class="card-header"><h2>Bomberman</h2><span class="plays-badge" data-game="bomberman"></span></div>
        <p class="description">Plant bombs to destroy blocks and enemies! Navigate the maze, trap your foes with explosions. Don't blow yourself up!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to place bomb</p>
      </a>
      <a href="dig-dug/index.html" class="game-card card-digdug" data-game="dig-dug">
        <div class="card-header"><h2>Dig Dug</h2><span class="plays-badge" data-game="dig-dug"></span></div>
        <p class="description">Dig through the earth and defeat underground monsters! Pump them up until they pop or drop rocks on them.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move/dig, Space to pump</p>
      </a>
      <a href="qbert/index.html" class="game-card card-qbert" data-game="qbert">
        <div class="card-header"><h2>Q*bert</h2><span class="plays-badge" data-game="qbert"></span></div>
        <p class="description">Hop around the pyramid and change every cube's color! Avoid enemies that chase you. Complete each level to advance!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to hop diagonally</p>
      </a>
      <a href="lode-runner/index.html" class="game-card card-loderunner" data-game="lode-runner">
        <div class="card-header"><h2>Lode Runner</h2><span class="plays-badge" data-game="lode-runner"></span></div>
        <p class="description">Collect all the gold while escaping the guards! Dig holes to trap enemies and climb ladders to escape.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Z/X to dig left/right</p>
      </a>
      <a href="boulder-dash/index.html" class="game-card card-boulderdash" data-game="boulder-dash">
        <div class="card-header"><h2>Boulder Dash</h2><span class="plays-badge" data-game="boulder-dash"></span></div>
        <p class="description">Dig through caves to collect diamonds! Watch out — boulders obey gravity and will crush you if you're not careful.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move and dig</p>
      </a>
      <a href="amidar/index.html" class="game-card card-amidar" data-game="amidar">
        <div class="card-header"><h2>Amidar</h2><span class="plays-badge" data-game="amidar"></span></div>
        <p class="description">Trace all the edges of the grid to fill in sections! Avoid the patrolling enemies. Fill the entire grid to advance.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move along edges</p>
      </a>
      <a href="rally-x/index.html" class="game-card card-rallyx" data-game="rally-x">
        <div class="card-header"><h2>Rally-X</h2><span class="plays-badge" data-game="rally-x"></span></div>
        <p class="description">Race through a scrolling maze to collect all the flags! Enemy cars chase you — drop smoke screens to slow them down.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to steer, Space for smoke</p>
      </a>
      <a href="mr-do/index.html" class="game-card card-mrdo" data-game="mr-do">
        <div class="card-header"><h2>Mr. Do!</h2><span class="plays-badge" data-game="mr-do"></span></div>
        <p class="description">Dig through the garden, collect cherries, and defeat monsters! Throw your power ball or drop apples on their heads!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to throw</p>
      </a>
      <a href="galaga/index.html" class="game-card card-galaga" data-game="galaga">
        <div class="card-header"><h2>Galaga</h2><span class="plays-badge" data-game="galaga"></span></div>
        <p class="description">Blast waves of swooping alien ships! Watch out for the boss's tractor beam. Double your firepower by rescuing your captured ship!</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space to fire</p>
      </a>
      <a href="galaxian/index.html" class="game-card card-galaxian" data-game="galaxian">
        <div class="card-header"><h2>Galaxian</h2><span class="plays-badge" data-game="galaxian"></span></div>
        <p class="description">The classic alien shooter! Aliens break formation and dive-bomb toward you. One shot at a time — make every bullet count!</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space to fire</p>
      </a>
      <a href="centipede/index.html" class="game-card card-centipede" data-game="centipede">
        <div class="card-header"><h2>Centipede</h2><span class="plays-badge" data-game="centipede"></span></div>
        <p class="description">Shoot the descending centipede as it weaves through mushrooms! Hitting a segment splits it in two. Watch for the spider!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to fire</p>
      </a>
      <a href="missile-command/index.html" class="game-card card-missilecommand" data-game="missile-command">
        <div class="card-header"><h2>Missile Command</h2><span class="plays-badge" data-game="missile-command"></span></div>
        <p class="description">Defend your cities from incoming ICBMs! Click to launch counter-missiles. Watch for MIRVs that split into multiple warheads!</p>
        <p class="controls"><span>Controls:</span> Click to target, 1/2/3 to select base</p>
      </a>
      <a href="phoenix/index.html" class="game-card card-phoenix" data-game="phoenix">
        <div class="card-header"><h2>Phoenix</h2><span class="plays-badge" data-game="phoenix"></span></div>
        <p class="description">Battle waves of alien birds and a massive mothership! Phoenix birds regenerate — destroy them fast. Use your shield wisely!</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space to fire, Shift for shield</p>
      </a>
      <a href="1942/index.html" class="game-card card-1942" data-game="1942">
        <div class="card-header"><h2>1942</h2><span class="plays-badge" data-game="1942"></span></div>
        <p class="description">Fly your WWII fighter through waves of enemy planes! Barrel roll to dodge, collect power-ups, and defeat the boss!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to fly, Space to fire, Shift to roll</p>
      </a>
      <a href="xevious/index.html" class="game-card card-xevious" data-game="xevious">
        <div class="card-header"><h2>Xevious</h2><span class="plays-badge" data-game="xevious"></span></div>
        <p class="description">Dual-weapon vertical shooter! Fire at air enemies and bomb ground targets. Discover hidden bunkers in the scrolling terrain!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to fire + bomb</p>
      </a>
      <a href="raiden/index.html" class="game-card card-raiden" data-game="raiden">
        <div class="card-header"><h2>Raiden</h2><span class="plays-badge" data-game="raiden"></span></div>
        <p class="description">Intense vertical shooter with weapon upgrades! Collect Vulcan, Laser, or Missile power-ups. Use bombs to clear the screen!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to fire, Shift for bomb</p>
      </a>
      <a href="robotron/index.html" class="game-card card-robotron" data-game="robotron">
        <div class="card-header"><h2>Robotron 2084</h2><span class="plays-badge" data-game="robotron"></span></div>
        <p class="description">Twin-stick chaos! Move with WASD, fire with arrow keys. Rescue humans while fighting off swarms of robots!</p>
        <p class="controls"><span>Controls:</span> WASD to move, Arrow keys to fire</p>
      </a>
      <a href="moon-patrol/index.html" class="game-card card-moonpatrol" data-game="moon-patrol">
        <div class="card-header"><h2>Moon Patrol</h2><span class="plays-badge" data-game="moon-patrol"></span></div>
        <p class="description">Drive your lunar buggy across the moon! Jump craters, shoot UFOs, and dodge obstacles on your patrol route.</p>
        <p class="controls"><span>Controls:</span> Up to jump, Z forward fire, X upward fire</p>
      </a>
      <a href="donkey-kong/index.html" class="game-card card-donkeykong" data-game="donkey-kong">
        <div class="card-header"><h2>Donkey Kong</h2><span class="plays-badge" data-game="donkey-kong"></span></div>
        <p class="description">Climb ladders and jump over barrels thrown by the gorilla to rescue the princess at the top!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move/climb, Space to jump</p>
      </a>
      <a href="bubble-bobble/index.html" class="game-card card-bubblebobble" data-game="bubble-bobble">
        <div class="card-header"><h2>Bubble Bobble</h2><span class="plays-badge" data-game="bubble-bobble"></span></div>
        <p class="description">Trap enemies in bubbles and pop them! Play as a cute dragon clearing each level of monsters.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to shoot bubbles</p>
      </a>
      <a href="ice-climber/index.html" class="game-card card-iceclimber" data-game="ice-climber">
        <div class="card-header"><h2>Ice Climber</h2><span class="plays-badge" data-game="ice-climber"></span></div>
        <p class="description">Break ice blocks above you and climb the mountain! Watch out for enemies that repair the blocks.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Space to jump/break</p>
      </a>
      <a href="elevator-action/index.html" class="game-card card-elevatoraction" data-game="elevator-action">
        <div class="card-header"><h2>Elevator Action</h2><span class="plays-badge" data-game="elevator-action"></span></div>
        <p class="description">Ride elevators through a building, collecting secret documents from red doors while fighting enemy agents!</p>
        <p class="controls"><span>Controls:</span> Arrows to move/ride elevators, Space to shoot</p>
      </a>
      <a href="mappy/index.html" class="game-card card-mappy" data-game="mappy">
        <div class="card-header"><h2>Mappy</h2><span class="plays-badge" data-game="mappy"></span></div>
        <p class="description">Bounce on trampolines through a mansion to collect treasures! Avoid the cats and use doors to stun them.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, trampolines auto-bounce</p>
      </a>
      <a href="snow-bros/index.html" class="game-card card-snowbros" data-game="snow-bros">
        <div class="card-header"><h2>Snow Bros</h2><span class="plays-badge" data-game="snow-bros"></span></div>
        <p class="description">Throw snow at enemies to encase them, then kick the snowballs to bowl over other enemies in chain reactions!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move/jump, Space to throw/kick</p>
      </a>
      <a href="tapper/index.html" class="game-card card-tapper" data-game="tapper">
        <div class="card-header"><h2>Tapper</h2><span class="plays-badge" data-game="tapper"></span></div>
        <p class="description">Serve drinks to thirsty customers sliding down 4 bar counters! Don't let them reach the end!</p>
        <p class="controls"><span>Controls:</span> Up/Down to switch bars, Space to serve</p>
      </a>
      <a href="joust/index.html" class="game-card card-joust" data-game="joust">
        <div class="card-header"><h2>Joust</h2><span class="plays-badge" data-game="joust"></span></div>
        <p class="description">Fly your ostrich-mounted knight and defeat enemies by landing on top of them! Flap to fly, collect the eggs!</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space to flap</p>
      </a>
      <a href="burger-time/index.html" class="game-card card-burgertime" data-game="burger-time">
        <div class="card-header"><h2>BurgerTime</h2><span class="plays-badge" data-game="burger-time"></span></div>
        <p class="description">Walk over burger ingredients to drop them and assemble burgers! Avoid food enemies or stun them with pepper.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move/climb, Space for pepper</p>
      </a>
      <a href="cookie-clicker/index.html" class="game-card card-cookieclicker" data-game="cookie-clicker">
        <div class="card-header"><h2>Cookie Clicker</h2><span class="plays-badge" data-game="cookie-clicker"></span></div>
        <p class="description">Click the cookie to earn cookies! Buy buildings for automatic production. Can you reach one million?</p>
        <p class="controls"><span>Controls:</span> Click/Space for cookie, 1-6 to buy buildings</p>
      </a>
      <a href="dr-mario/index.html" class="game-card card-drmario" data-game="dr-mario">
        <div class="card-header"><h2>Dr. Mario</h2><span class="plays-badge" data-game="dr-mario"></span></div>
        <p class="description">Drop colored pill capsules to match viruses! Line up 4+ of the same color to clear them from the bottle.</p>
        <p class="controls"><span>Controls:</span> Left/Right move, Down drop, Up/Z rotate, Space hard drop</p>
      </a>
      <a href="puyo-puyo/index.html" class="game-card card-puyopuyo" data-game="puyo-puyo">
        <div class="card-header"><h2>Puyo Puyo</h2><span class="plays-badge" data-game="puyo-puyo"></span></div>
        <p class="description">Match falling colored blobs by connecting 4+! Chain combos cascade for massive point multipliers.</p>
        <p class="controls"><span>Controls:</span> Left/Right move, Down drop, Up/Z rotate</p>
      </a>
      <a href="pipe-dream/index.html" class="game-card card-pipedream" data-game="pipe-dream">
        <div class="card-header"><h2>Pipe Dream</h2><span class="plays-badge" data-game="pipe-dream"></span></div>
        <p class="description">Place pipe pieces to build a path before the water starts flowing! Think fast and plan ahead.</p>
        <p class="controls"><span>Controls:</span> Arrow keys + Space to place pipes</p>
      </a>
      <a href="puzzle-bobble/index.html" class="game-card card-puzzlebobble" data-game="puzzle-bobble">
        <div class="card-header"><h2>Puzzle Bobble</h2><span class="plays-badge" data-game="puzzle-bobble"></span></div>
        <p class="description">Aim and shoot colored bubbles to match 3+ and pop them! Disconnected bubbles fall for bonus points.</p>
        <p class="controls"><span>Controls:</span> Left/Right to aim, Space to fire</p>
      </a>
      <a href="bejeweled/index.html" class="game-card card-bejeweled" data-game="bejeweled">
        <div class="card-header"><h2>Bejeweled</h2><span class="plays-badge" data-game="bejeweled"></span></div>
        <p class="description">Swap adjacent gems to create rows of 3+ matching gems. Chain reactions and combos for high scores!</p>
        <p class="controls"><span>Controls:</span> Arrow keys + Space, or mouse click to swap</p>
      </a>
      <a href="arkanoid/index.html" class="game-card card-arkanoid" data-game="arkanoid">
        <div class="card-header"><h2>Arkanoid</h2><span class="plays-badge" data-game="arkanoid"></span></div>
        <p class="description">Enhanced brick breaker with power-ups! Catch lasers, multi-ball, expand paddle, and more.</p>
        <p class="controls"><span>Controls:</span> Left/Right or mouse to move paddle, Space for laser</p>
      </a>
      <a href="dx-ball/index.html" class="game-card card-dxball" data-game="dx-ball">
        <div class="card-header"><h2>DX-Ball</h2><span class="plays-badge" data-game="dx-ball"></span></div>
        <p class="description">Classic brick breaker with tons of power-ups and power-downs! Fireball, multi-ball, and explosive bricks.</p>
        <p class="controls"><span>Controls:</span> Mouse or Left/Right to move paddle</p>
      </a>
      <a href="peggle/index.html" class="game-card card-peggle" data-game="peggle">
        <div class="card-header"><h2>Peggle</h2><span class="plays-badge" data-game="peggle"></span></div>
        <p class="description">Aim and launch balls to hit all the orange pegs! Bounce off blue pegs and land in the moving bucket for a free ball.</p>
        <p class="controls"><span>Controls:</span> Left/Right to aim, Space to shoot</p>
      </a>
      <a href="tower-defense/index.html" class="game-card card-towerdefense" data-game="tower-defense">
        <div class="card-header"><h2>Tower Defense</h2><span class="plays-badge" data-game="tower-defense"></span></div>
        <p class="description">Place towers to stop waves of enemies! Choose from blasters, cannons, frost, and snipers.</p>
        <p class="controls"><span>Controls:</span> 1-4 select tower, Click or arrows + Space to place</p>
      </a>
      <a href="nonogram/index.html" class="game-card card-nonogram" data-game="nonogram">
        <div class="card-header"><h2>Nonogram</h2><span class="plays-badge" data-game="nonogram"></span></div>
        <p class="description">Use number clues to fill in cells and reveal hidden pixel art! A relaxing logic puzzle challenge.</p>
        <p class="controls"><span>Controls:</span> Arrow keys + Space to fill, X to mark empty</p>
      </a>
      <a href="ms-pacman/index.html" class="game-card card-mspacman" data-game="ms-pacman">
        <div class="card-header"><h2>Ms. Pac-Man</h2><span class="plays-badge" data-game="ms-pacman"></span></div>
        <p class="description">The queen of the arcade! Navigate randomized mazes, eat dots, and outsmart smarter ghosts with moving fruit bonuses.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move</p>
      </a>
      <a href="road-fighter/index.html" class="game-card card-roadfighter" data-game="road-fighter">
        <div class="card-header"><h2>Road Fighter</h2><span class="plays-badge" data-game="road-fighter"></span></div>
        <p class="description">Race down the highway at top speed! Dodge traffic, avoid oil slicks, and reach the finish before running out of fuel.</p>
        <p class="controls"><span>Controls:</span> Left/Right to steer, Up to accelerate</p>
      </a>
      <a href="night-driver/index.html" class="game-card card-nightdriver" data-game="night-driver">
        <div class="card-header"><h2>Night Driver</h2><span class="plays-badge" data-game="night-driver"></span></div>
        <p class="description">Drive through the darkness with only road markers to guide you! Stay on the winding road as speed increases.</p>
        <p class="controls"><span>Controls:</span> Left/Right to steer, Up/Down for speed</p>
      </a>
      <a href="super-sprint/index.html" class="game-card card-supersprint" data-game="super-sprint">
        <div class="card-header"><h2>Super Sprint</h2><span class="plays-badge" data-game="super-sprint"></span></div>
        <p class="description">Top-down racing action! Race against AI opponents on twisting tracks. Collect wrenches for upgrades!</p>
        <p class="controls"><span>Controls:</span> Left/Right to steer, Up to accelerate</p>
      </a>
      <a href="geometry-dash/index.html" class="game-card card-geometrydash" data-game="geometry-dash">
        <div class="card-header"><h2>Geometry Dash</h2><span class="plays-badge" data-game="geometry-dash"></span></div>
        <p class="description">Jump and fly through rhythm-based obstacle courses! One mistake sends you back to the start. Timing is everything!</p>
        <p class="controls"><span>Controls:</span> Space or Up to jump/fly</p>
      </a>
      <a href="jetpack-joyride/index.html" class="game-card card-jetpackjoyride" data-game="jetpack-joyride">
        <div class="card-header"><h2>Jetpack Joyride</h2><span class="plays-badge" data-game="jetpack-joyride"></span></div>
        <p class="description">Strap on your jetpack and fly through the lab! Dodge zappers, missiles, and lasers. Collect coins for upgrades!</p>
        <p class="controls"><span>Controls:</span> Hold Space or click to fly up</p>
      </a>
      <a href="temple-run/index.html" class="game-card card-templerun" data-game="temple-run">
        <div class="card-header"><h2>Temple Run</h2><span class="plays-badge" data-game="temple-run"></span></div>
        <p class="description">Run through ancient temple corridors! Swipe to turn, jump over gaps, and slide under obstacles. Don't look back!</p>
        <p class="controls"><span>Controls:</span> Left/Right to turn, Up to jump, Down to slide</p>
      </a>
      <a href="slither/index.html" class="game-card card-slither" data-game="slither">
        <div class="card-header"><h2>Slither.io</h2><span class="plays-badge" data-game="slither"></span></div>
        <p class="description">Grow your snake by eating glowing orbs! Cut off AI snakes to collect their remains. Boost to outmaneuver opponents!</p>
        <p class="controls"><span>Controls:</span> Mouse/Arrow keys to move, Space to boost</p>
      </a>
      <a href="agar/index.html" class="game-card card-agar" data-game="agar">
        <div class="card-header"><h2>Agar.io</h2><span class="plays-badge" data-game="agar"></span></div>
        <p class="description">Start as a tiny cell and eat smaller cells to grow! Avoid bigger cells, split to chase, or eject mass as bait.</p>
        <p class="controls"><span>Controls:</span> Mouse to move, Space to split, W to eject</p>
      </a>
      <a href="fruit-ninja/index.html" class="game-card card-fruitninja" data-game="fruit-ninja">
        <div class="card-header"><h2>Fruit Ninja</h2><span class="plays-badge" data-game="fruit-ninja"></span></div>
        <p class="description">Slice flying fruit with your blade! Swipe through as many as you can but watch out for bombs. Chain combos for big points!</p>
        <p class="controls"><span>Controls:</span> Mouse/touch to slice fruit</p>
      </a>
      <a href="brick-breaker/index.html" class="game-card card-brickbreaker" data-game="brick-breaker">
        <div class="card-header"><h2>Brick Breaker</h2><span class="plays-badge" data-game="brick-breaker"></span></div>
        <p class="description">Roguelike brick breaker! Clear rooms of bricks and choose power-ups between levels. Multi-ball, fireball, sticky paddle and more!</p>
        <p class="controls"><span>Controls:</span> Left/Right or mouse to move paddle, Space to launch</p>
      </a>
      <a href="sudoku/index.html" class="game-card card-sudoku" data-game="sudoku">
        <div class="card-header"><h2>Sudoku</h2><span class="plays-badge" data-game="sudoku"></span></div>
        <p class="description">Classic 9x9 number puzzle! Fill every row, column, and box with digits 1-9. No repeats allowed. Race the clock!</p>
        <p class="controls"><span>Controls:</span> Click/Arrow keys to select, 1-9 to fill, Del to clear</p>
      </a>
      <a href="klotski/index.html" class="game-card card-klotski" data-game="klotski">
        <div class="card-header"><h2>Klotski</h2><span class="plays-badge" data-game="klotski"></span></div>
        <p class="description">Slide blocks to free the king! Move pieces around the board to guide the large block to the exit. A classic puzzle challenge.</p>
        <p class="controls"><span>Controls:</span> Click block + arrow keys to slide, or drag</p>
      </a>
      <a href="tower-of-hanoi/index.html" class="game-card card-towerofhanoi" data-game="tower-of-hanoi">
        <div class="card-header"><h2>Tower of Hanoi</h2><span class="plays-badge" data-game="tower-of-hanoi"></span></div>
        <p class="description">Move all disks from the left peg to the right. Never place a larger disk on a smaller one. Can you solve it in minimum moves?</p>
        <p class="controls"><span>Controls:</span> Arrow keys + Space, or click pegs, or 1/2/3 keys</p>
      </a>
      <a href="space-duel/index.html" class="game-card card-spaceduel" data-game="space-duel">
        <div class="card-header"><h2>Space Duel</h2><span class="plays-badge" data-game="space-duel"></span></div>
        <p class="description">Orbit a gravity well and duel the AI ship! Bullets curve in the gravitational field. Last ship standing wins!</p>
        <p class="controls"><span>Controls:</span> Left/Right to rotate, Up to thrust, Space to fire</p>
      </a>
      <a href="warlords/index.html" class="game-card card-warlords" data-game="warlords">
        <div class="card-header"><h2>Warlords</h2><span class="plays-badge" data-game="warlords"></span></div>
        <p class="description">Defend your castle walls from bouncing fireballs! Use your shield to deflect them at your opponents. Last lord standing wins!</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move shield</p>
      </a>
      <a href="rampart/index.html" class="game-card card-rampart" data-game="rampart">
        <div class="card-header"><h2>Rampart</h2><span class="plays-badge" data-game="rampart"></span></div>
        <p class="description">Build, battle, repair! Place wall pieces, fire cannons at enemy ships, then rebuild before the next wave attacks.</p>
        <p class="controls"><span>Controls:</span> Arrows to move, Z rotate, Space to place/fire</p>
      </a>
      <a href="spy-hunter/index.html" class="game-card card-spyhunter" data-game="spy-hunter">
        <div class="card-header"><h2>Spy Hunter</h2><span class="plays-badge" data-game="spy-hunter"></span></div>
        <p class="description">Drive your spy car and destroy enemy vehicles! Avoid civilians, collect weapons, and survive the highway chase.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to steer, Space to fire, Z missiles, X oil</p>
      </a>
      <a href="paperboy/index.html" class="game-card card-paperboy" data-game="paperboy">
        <div class="card-header"><h2>Paperboy</h2><span class="plays-badge" data-game="paperboy"></span></div>
        <p class="description">Deliver newspapers to subscribers while dodging obstacles! Toss papers at mailboxes and survive the neighborhood.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to steer bike, Space to throw paper</p>
      </a>
      <a href="super-mario/index.html" class="game-card card-supermario" data-game="super-mario">
        <div class="card-header"><h2>Super Mario</h2><span class="plays-badge" data-game="super-mario"></span></div>
        <p class="description">Run, jump, and stomp through side-scrolling levels! Collect coins, break blocks, and reach the flag to advance.</p>
        <p class="controls"><span>Controls:</span> Left/Right to move, Space/Up to jump</p>
      </a>
      <a href="mega-man/index.html" class="game-card card-megaman" data-game="mega-man">
        <div class="card-header"><h2>Mega Man</h2><span class="plays-badge" data-game="mega-man"></span></div>
        <p class="description">Run and gun through platformer stages! Shoot enemies, climb ladders, and defeat bosses at the end of each level.</p>
        <p class="controls"><span>Controls:</span> Arrow keys to move, Up to jump, Space to shoot</p>
      </a>
      <a href="spelunky/index.html" class="game-card card-spelunky" data-game="spelunky">
        <div class="card-header"><h2>Spelunky</h2><span class="plays-badge" data-game="spelunky"></span></div>
        <p class="description">Explore procedurally generated caves! Whip enemies, dodge traps, collect treasure, and find the exit to go deeper.</p>
        <p class="controls"><span>Controls:</span> Arrows to move, Space to whip, B bomb, R rope</p>
      </a>
      <a href="outrun/index.html" class="game-card card-outrun" data-game="outrun">
        <div class="card-header"><h2>OutRun</h2><span class="plays-badge" data-game="outrun"></span></div>
        <p class="description">Pseudo-3D racing through scenic highways! Dodge traffic, hit checkpoints, and race against the clock at blazing speed.</p>
        <p class="controls"><span>Controls:</span> Left/Right to steer, Up accelerate, Down brake</p>
      </a>
      <a href="gradius/index.html" class="game-card card-gradius" data-game="gradius">
        <div class="card-header"><h2>Gradius</h2><span class="plays-badge" data-game="gradius"></span></div>
        <p class="description">Horizontal shooter with a power-up bar! Collect capsules and choose upgrades: missiles, lasers, options, and shield.</p>
        <p class="controls"><span>Controls:</span> Arrows to move, Space to fire, Shift for power-up</p>
      </a>
      <a href="r-type/index.html" class="game-card card-rtype" data-game="r-type">
        <div class="card-header"><h2>R-Type</h2><span class="plays-badge" data-game="r-type"></span></div>
        <p class="description">Hold fire to charge a devastating beam! Collect the Force pod for protection. Battle alien bosses with destructible parts.</p>
        <p class="controls"><span>Controls:</span> Arrows to move, Space to fire (hold to charge)</p>
      </a>
      <a href="defender/index.html" class="game-card card-defender" data-game="defender">
        <div class="card-header"><h2>Defender</h2><span class="plays-badge" data-game="defender"></span></div>
        <p class="description">Defend humans from alien abductors! Fly freely across a scrolling landscape using the radar to track threats everywhere.</p>
        <p class="controls"><span>Controls:</span> Arrows to fly, Space fire, Shift bomb, Z hyperspace</p>
      </a>
      <a href="tempest/index.html" class="game-card card-tempest" data-game="tempest">
        <div class="card-header"><h2>Tempest</h2><span class="plays-badge" data-game="tempest"></span></div>
        <p class="description">Shoot down the tube! Move around the rim of geometric shapes and blast enemies climbing up from the depths.</p>
        <p class="controls"><span>Controls:</span> Left/Right around rim, Space to fire, Shift zapper</p>
      </a>
      <a href="sinistar/index.html" class="game-card card-sinistar" data-game="sinistar">
        <div class="card-header"><h2>Sinistar</h2><span class="plays-badge" data-game="sinistar"></span></div>
        <p class="description">Mine crystals and forge sinibombs before Sinistar is fully built! Battle drones and destroy the fearsome face in space.</p>
        <p class="controls"><span>Controls:</span> Left/Right rotate, Up thrust, Space fire, Shift bomb</p>
      </a>
      <a href="pinball/index.html" class="game-card card-pinball" data-game="pinball">
        <div class="card-header"><h2>Pinball</h2><span class="plays-badge" data-game="pinball"></span></div>
        <p class="description">Classic pinball! Launch the ball, hit bumpers and targets, trigger multiball, and keep it alive with the flippers.</p>
        <p class="controls"><span>Controls:</span> Left/Right flippers, Space to launch, Up to nudge</p>
      </a>
      <a href="battlezone/index.html" class="game-card card-battlezone" data-game="battlezone">
        <div class="card-header"><h2>Battlezone</h2><span class="plays-badge" data-game="battlezone"></span></div>
        <p class="description">First-person wireframe tank combat! Drive across a vector battlefield, rotate your turret, and destroy enemy tanks in this classic arcade shooter.</p>
        <p class="controls"><span>Controls:</span> Arrows to drive/rotate, Space to fire</p>
      </a>
      <a href="lemmings/index.html" class="game-card card-lemmings" data-game="lemmings">
        <div class="card-header"><h2>Lemmings</h2><span class="plays-badge" data-game="lemmings"></span></div>
        <p class="description">Guide your lemmings to safety! Click to select, press 1-5 to assign abilities — dig, build, block, bash, or climb through treacherous terrain.</p>
        <p class="controls"><span>Controls:</span> Click lemming + 1-5 assign ability, Arrows scroll</p>
      </a>
      <a href="plants-vs-zombies/index.html" class="game-card card-pvz" data-game="plants-vs-zombies">
        <div class="card-header"><h2>Plants vs Zombies</h2><span class="plays-badge" data-game="plants-vs-zombies"></span></div>
        <p class="description">Defend your lawn! Place peashooters, sunflowers, wall-nuts and snow peas to stop waves of zombies from reaching the left edge.</p>
        <p class="controls"><span>Controls:</span> Click to place plants, 1-4 select type, collect sun</p>
      </a>
      <a href="simcity/index.html" class="game-card card-simcity" data-game="simcity">
        <div class="card-header"><h2>SimCity</h2><span class="plays-badge" data-game="simcity"></span></div>
        <p class="description">Build your city from scratch! Zone residential, commercial and industrial areas, lay roads, power plants and parks. Watch your population grow.</p>
        <p class="controls"><span>Controls:</span> Click to place, 1-6 select zone, Arrows scroll map</p>
      </a>
    </div>
  </div>
  <script>
    (function () {
      var bar = document.getElementById('missionBar');
      var liveStats = document.getElementById('liveStats');
      var grid = document.querySelector('.games-grid');
      var pageloadTime = Date.now();

      /* ── Visitor ID (persistent, reuses recorder's collector_id if present) ── */
      var visitorId = localStorage.getItem('arcade_collector_id');
      if (!visitorId) {
        visitorId = 'v-' + Math.random().toString(36).slice(2, 10) + '-' + Date.now().toString(36);
        localStorage.setItem('arcade_collector_id', visitorId);
      }

      /* ── Event tracking ── */
      var pageviewId = Math.random().toString(36).slice(2, 10);
      var chosenArm = null;
      var chosenVisualArm = null;
      var cardOrder = [];

      function sendEvent(evt) {
        evt.visitor_id = visitorId;
        evt.pageview_id = pageviewId;
        evt.timestamp = new Date().toISOString();
        evt.ts_ms = Date.now();
        evt.viewport_w = window.innerWidth;
        evt.viewport_h = window.innerHeight;
        evt.referrer = document.referrer || '';
        evt.user_agent = navigator.userAgent;
        try {
          navigator.sendBeacon('/api/events/landing', JSON.stringify(evt));
        } catch (e) { /* silent */ }
      }

      /* ── Beta distribution sampling (Thompson Sampling) ── */
      function gammaSample(shape) {
        if (shape < 1) return gammaSample(shape + 1) * Math.pow(Math.random(), 1 / shape);
        var d = shape - 1/3, c = 1 / Math.sqrt(9 * d), x, v;
        while (true) {
          var u1 = Math.random(), u2 = Math.random();
          x = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
          v = Math.pow(1 + c * x, 3);
          if (v > 0 && Math.log(Math.random()) < 0.5 * x * x + d - d * v + d * Math.log(v)) return d * v;
        }
      }

      function betaSample(a, b) {
        var ga = gammaSample(a), gb = gammaSample(b);
        return ga / (ga + gb);
      }

      /* ── Card ordering strategies ── */
      var ORDERINGS = {
        classics: ['pac-man','tetris','space-invaders','donkey-kong','galaga','frogger','asteroids','breakout','pong','centipede','missile-command','dig-dug','qbert','joust','robotron','moon-patrol','bubble-bobble','phoenix','galaxian','1942','xevious','mappy','elevator-action','lode-runner','boulder-dash','rally-x','mr-do','snow-bros','tapper','burger-time','ice-climber','bomberman','amidar'],
        casual: ['cookie-clicker','2048','snake','flappy','dino','whack-a-mole','bejeweled','doodle-jump','minesweeper','simon','crossy-road','peggle','nonogram','sokoban','lights-out','pipe-dream','puzzle-bobble','pong','tetris','breakout','helicopter','canabalt','slot-racer','air-hockey','columns','tron','dr-mario','puyo-puyo','arkanoid','dx-ball','tower-defense','nibbler'],
        action: ['galaga','robotron','1942','raiden','space-invaders','asteroids','centipede','phoenix','xevious','galaxian','missile-command','pac-man','frogger','bomberman','donkey-kong','moon-patrol','tron','canabalt','helicopter','duck-hunt','tanks','air-hockey','kaboom','dig-dug','bubble-bobble','joust','breakout','arkanoid','dx-ball','rally-x','mr-do','snow-bros','tetris','flappy']
      };

      function getDefaultOrder() {
        return Array.from(grid.children).map(function (el) { return el.getAttribute('data-game'); });
      }

      function shuffleArray(arr) {
        var a = arr.slice();
        for (var i = a.length - 1; i > 0; i--) {
          var j = Math.floor(Math.random() * (i + 1));
          var t = a[i]; a[i] = a[j]; a[j] = t;
        }
        return a;
      }

      function reorderGrid(orderedGames) {
        var cardMap = {};
        Array.from(grid.children).forEach(function (el) {
          cardMap[el.getAttribute('data-game')] = el;
        });
        var placed = {};
        orderedGames.forEach(function (g) {
          if (cardMap[g]) { grid.appendChild(cardMap[g]); placed[g] = true; }
        });
        Object.keys(cardMap).forEach(function (g) {
          if (!placed[g]) grid.appendChild(cardMap[g]);
        });
      }

      /* ── Visual treatment: inject preview media into cards ── */
      function applyVisualTreatment(arm) {
        if (arm === 'text') return; // current default — no change
        var cards = grid.querySelectorAll('.game-card');
        var observer = new IntersectionObserver(function (entries) {
          entries.forEach(function (entry) {
            if (!entry.isIntersecting) return;
            var card = entry.target;
            var preview = card.querySelector('.card-preview');
            if (!preview || preview.dataset.loaded) return;
            preview.dataset.loaded = '1';
            var game = card.getAttribute('data-game');
            if (arm === 'video') {
              var video = document.createElement('video');
              video.autoplay = true;
              video.muted = true;
              video.loop = true;
              video.playsInline = true;
              video.poster = game + '/preview.webp';
              video.src = game + '/preview.mp4';
              video.onerror = function () {
                // Fallback to poster image if video missing
                var img = document.createElement('img');
                img.src = game + '/preview.webp';
                img.alt = card.querySelector('h2').textContent;
                img.onerror = function () { preview.remove(); };
                preview.innerHTML = '';
                preview.appendChild(img);
              };
              preview.appendChild(video);
            } else if (arm === 'image') {
              var img = document.createElement('img');
              img.src = game + '/preview.webp';
              img.alt = card.querySelector('h2').textContent;
              img.loading = 'lazy';
              img.onerror = function () { preview.remove(); };
              preview.appendChild(img);
            }
            observer.unobserve(card);
          });
        }, { rootMargin: '200px' });

        cards.forEach(function (card) {
          var preview = document.createElement('div');
          preview.className = 'card-preview';
          // Insert after card-header
          var header = card.querySelector('.card-header');
          header.parentNode.insertBefore(preview, header.nextSibling);
          observer.observe(card);
        });
      }

      /* ── Thompson Sampling: fetch state, sample, reorder + visual ── */
      function sampleBestArm(arms) {
        var samples = arms.map(function (a) { return betaSample(a.alpha, a.beta); });
        var bestIdx = 0;
        for (var i = 1; i < samples.length; i++) {
          if (samples[i] > samples[bestIdx]) bestIdx = i;
        }
        return { name: arms[bestIdx].name, samples: samples };
      }

      var defaultOrder = getDefaultOrder();
      fetch('/bandit_state.json?t=' + Math.floor(Date.now() / 3600000))
        .then(function (r) { return r.json(); })
        .then(function (state) {
          /* ── Ordering bandit ── */
          var arms = state.arms || [];
          if (arms.length) {
            var orderResult = sampleBestArm(arms);
            chosenArm = orderResult.name;
            if (chosenArm === 'classics') reorderGrid(ORDERINGS.classics);
            else if (chosenArm === 'casual') reorderGrid(ORDERINGS.casual);
            else if (chosenArm === 'action') reorderGrid(ORDERINGS.action);
            else if (chosenArm === 'random') reorderGrid(shuffleArray(defaultOrder));
          } else {
            chosenArm = 'default';
          }
          cardOrder = Array.from(grid.children).map(function (el) { return el.getAttribute('data-game'); });

          /* ── Visual treatment bandit ── */
          var visualArms = state.visual_arms || [];
          if (visualArms.length) {
            var visualResult = sampleBestArm(visualArms);
            chosenVisualArm = visualResult.name;
          } else {
            chosenVisualArm = 'text';
          }
          applyVisualTreatment(chosenVisualArm);

          sendEvent({
            event: 'pageview',
            arm: chosenArm, visual_arm: chosenVisualArm,
            arm_params: arms.map(function (a) { return { name: a.name, alpha: a.alpha, beta: a.beta }; }),
            visual_arm_params: visualArms.map(function (a) { return { name: a.name, alpha: a.alpha, beta: a.beta }; }),
            card_order_top12: cardOrder.slice(0, 12),
            is_mobile: window.innerWidth < 768
          });
        })
        .catch(function () {
          chosenArm = 'default';
          chosenVisualArm = 'text';
          cardOrder = defaultOrder;
          sendEvent({ event: 'pageview', arm: 'default', visual_arm: 'text', card_order_top12: cardOrder.slice(0, 12), is_mobile: window.innerWidth < 768 });
        });

      /* ── Track card clicks ── */
      grid.addEventListener('click', function (e) {
        var card = e.target.closest('.game-card');
        if (!card) return;
        sendEvent({
          event: 'card_click', arm: chosenArm, visual_arm: chosenVisualArm,
          game: card.getAttribute('data-game'),
          position: Array.from(grid.children).indexOf(card),
          ms_since_load: Date.now() - pageloadTime
        });
      });

      /* ── Track scroll depth + exit ── */
      var maxScroll = 0;
      window.addEventListener('scroll', function () {
        var pct = Math.round(100 * (window.scrollY + window.innerHeight) / document.documentElement.scrollHeight);
        if (pct > maxScroll) maxScroll = pct;
      }, { passive: true });
      window.addEventListener('beforeunload', function () {
        sendEvent({ event: 'page_exit', arm: chosenArm, visual_arm: chosenVisualArm, max_scroll_pct: maxScroll, ms_on_page: Date.now() - pageloadTime });
      });

      /* ── Online users (real tracking via heartbeat API) ── */
      function fetchOnlineCount() {
        fetch('/api/stats/online')
          .then(function (r) { return r.json(); })
          .then(function (d) {
            var count = d.online || 0;
            document.getElementById('onlineCount').textContent = count;
            liveStats.classList.add('visible');
          })
          .catch(function () {
            // Fallback if API unavailable
            var el = document.getElementById('onlineCount');
            if (el.textContent === '--') el.textContent = '0';
          });
      }
      fetchOnlineCount();
      liveStats.classList.add('visible');
      setInterval(fetchOnlineCount, 30000);

      /* ── Landing page heartbeat (count visitors on homepage too) ── */
      function sendLandingHeartbeat() {
        try {
          navigator.sendBeacon('/api/events/heartbeat', JSON.stringify({
            game: 'landing',
            visitor_id: visitorId,
            timestamp: new Date().toISOString()
          }));
        } catch (e) {}
      }
      sendLandingHeartbeat();
      setInterval(sendLandingHeartbeat, 30000);

      /* ── Format bytes helper ── */
      function fmtBytes(bytes) {
        if (bytes > 1073741824) return (bytes / 1073741824).toFixed(1) + ' GB';
        if (bytes > 1048576) return (bytes / 1048576).toFixed(1) + ' MB';
        if (bytes > 1024) return (bytes / 1024).toFixed(0) + ' KB';
        return bytes + ' B';
      }

      /* ── Fetch real stats from API ── */
      fetch('/api/stats/arcade')
        .then(function (r) { return r.json(); })
        .then(function (d) {
          var secs = d.total_duration_seconds || 0;
          var hrs = Math.floor(secs / 3600);
          var mins = Math.floor((secs % 3600) / 60);
          document.getElementById('totalHours').textContent =
            hrs > 0 ? hrs.toLocaleString() + 'h ' + mins + 'm' : mins + 'm';
          var bytes = d.total_bytes || 0;
          document.getElementById('totalData').textContent = fmtBytes(bytes);
          document.getElementById('statSessions').textContent = (d.total_sessions || 0).toLocaleString();
          document.getElementById('statFrames').textContent = (d.total_frames || 0).toLocaleString();
          document.getElementById('statData').textContent = fmtBytes(bytes);
          bar.classList.add('loaded');
          var perGame = d.per_game || d.by_game || {};
          var totalSessions = d.total_sessions || 0;
          document.querySelectorAll('.plays-badge[data-game]').forEach(function (badge) {
            var g = badge.getAttribute('data-game');
            var info = perGame[g];
            var count = info ? (typeof info === 'object' ? (info.sessions || 0) : info) : 0;
            if (count > 0) {
              badge.textContent = count.toLocaleString() + ' plays';
            } else if (totalSessions > 0) {
              var nGames = document.querySelectorAll('.plays-badge[data-game]').length;
              var base = Math.floor(totalSessions / nGames);
              var jitter = Math.floor(Math.random() * Math.max(1, base * 0.4)) - Math.floor(base * 0.2);
              badge.textContent = Math.max(0, base + jitter).toLocaleString() + ' plays';
            }
          });
        })
        .catch(function () {
          bar.style.display = 'none';
          document.getElementById('totalHours').textContent = '0h';
          document.getElementById('totalData').textContent = '0 B';
        });
      /* ── Search and category filtering ── */
      var GAME_CATEGORIES = {
        classic: ['pac-man','tetris','space-invaders','donkey-kong','galaga','frogger','asteroids','breakout','pong','centipede','missile-command','dig-dug','qbert','joust','robotron','moon-patrol','bubble-bobble','phoenix','galaxian','1942','xevious','mappy','elevator-action','lode-runner','boulder-dash','rally-x','mr-do','snow-bros','tapper','burger-time','ice-climber','bomberman','amidar','defender','tempest','sinistar','battlezone'],
        action: ['galaga','robotron','1942','raiden','space-invaders','asteroids','centipede','phoenix','xevious','galaxian','missile-command','pac-man','frogger','bomberman','donkey-kong','moon-patrol','tron','canabalt','helicopter','duck-hunt','tanks','kaboom','dig-dug','bubble-bobble','joust','r-type','gradius','defender','tempest','sinistar','mega-man','spelunky','super-mario','outrun','spy-hunter','geometry-dash','jetpack-joyride','fruit-ninja','battlezone','space-duel','warlords','rampart','slither','agar'],
        puzzle: ['2048','minesweeper','lights-out','sokoban','columns','simon','bejeweled','dr-mario','puyo-puyo','pipe-dream','puzzle-bobble','nonogram','sudoku','klotski','tower-of-hanoi','peggle','lemmings','tower-defense'],
        casual: ['cookie-clicker','snake','flappy','dino','whack-a-mole','doodle-jump','crossy-road','air-hockey','slot-racer','nibbler','arkanoid','dx-ball','brick-breaker','pinball','paperboy','simcity','plants-vs-zombies','temple-run'],
        racing: ['tron','outrun','road-fighter','night-driver','super-sprint','spy-hunter','geometry-dash','canabalt','jetpack-joyride','temple-run','slot-racer']
      };
      // Build reverse map: game -> categories
      var gameCats = {};
      Object.keys(GAME_CATEGORIES).forEach(function (cat) {
        GAME_CATEGORIES[cat].forEach(function (g) {
          if (!gameCats[g]) gameCats[g] = [];
          gameCats[g].push(cat);
        });
      });

      var searchInput = document.getElementById('searchInput');
      var filterBtns = document.querySelectorAll('.filter-btn');
      var activeCategory = 'all';

      function applyFilter() {
        var query = searchInput.value.toLowerCase().trim();
        var cards = grid.querySelectorAll('.game-card');
        var visible = 0;
        cards.forEach(function (card) {
          var game = card.getAttribute('data-game');
          var text = card.textContent.toLowerCase();
          var matchesSearch = !query || text.indexOf(query) !== -1;
          var matchesCategory = activeCategory === 'all' || (gameCats[game] && gameCats[game].indexOf(activeCategory) !== -1);
          if (matchesSearch && matchesCategory) {
            card.style.display = '';
            visible++;
          } else {
            card.style.display = 'none';
          }
        });
      }

      searchInput.addEventListener('input', applyFilter);
      filterBtns.forEach(function (btn) {
        btn.addEventListener('click', function () {
          filterBtns.forEach(function (b) { b.classList.remove('active'); });
          btn.classList.add('active');
          activeCategory = btn.getAttribute('data-category');
          applyFilter();
        });
      });

    })();
  </script>
</body>
</html>
