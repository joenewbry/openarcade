<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Builder — OpenArcade</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='12' fill='%238b5cf6'/><text x='50' y='70' font-size='55' font-family='Arial,sans-serif' font-weight='bold' fill='white' text-anchor='middle'>G</text></svg>">
  <link rel="stylesheet" href="builder.css">
</head>
<body>

<!-- ── Header ─────────────────────────────────────────────── -->
<header class="gb-header">
  <a href="/" class="gb-logo">ARCADE</a>
  <span class="gb-breadcrumb">/ Game Builder</span>

  <div class="gb-phase-indicator" title="Explore → Load → Design → Visualize → Generating → Playing">
    <div class="gb-phase-dot active" title="Explore"></div>
    <div class="gb-phase-dot" title="Load"></div>
    <div class="gb-phase-dot" title="Design"></div>
    <div class="gb-phase-dot" title="Visualize"></div>
    <div class="gb-phase-dot" title="Generating"></div>
    <div class="gb-phase-dot" title="Playing"></div>
  </div>

  <a href="/genre-explorer/" class="gb-lib-link" target="_blank">Game Types ↗</a>
  <a href="/library-ontology/" class="gb-lib-link" target="_blank">Tech Stack ↗</a>
</header>

<!-- ── Global Progress Bar ────────────────────────────────── -->
<div class="gb-global-progress">
  <div class="gb-global-progress-fill" id="gbGlobalProgressFill"></div>
  <div class="gb-global-progress-ticks">
    <div class="gb-tick" style="left:25%"></div>
    <div class="gb-tick" style="left:50%"></div>
    <div class="gb-tick" style="left:75%"></div>
  </div>
  <div class="gb-global-progress-label" id="gbGlobalProgressLabel">0%</div>
</div>

<!-- ── Main ───────────────────────────────────────────────── -->
<main class="gb-main">

  <!-- ── Chat sidebar ──────────────────────────────────────── -->
  <aside class="gb-chat">

    <!-- Design checklist -->
    <div class="gb-checklist">
      <div class="gb-checklist-title">Game Ontology</div>
      <div class="gb-design-progress">
        <div class="gb-design-progress-fill" id="gbDesignProgress"></div>
      </div>
      <div class="gb-checks" id="gbChecks">
        <!-- Rendered by builder.js -->
      </div>
    </div>

    <!-- Messages -->
    <div class="gb-messages" id="gbMessages"></div>

    <!-- Generate button (shown when ready) -->
    <button class="gb-generate-btn" id="gbGenerateBtn"></button>

    <!-- Input -->
    <div class="gb-input-row" id="gbInputRow">
      <textarea
        class="gb-input"
        id="gbInput"
        placeholder="Describe your game idea…"
        rows="1"
        maxlength="2000"
        autocomplete="off"
        spellcheck="false"
      ></textarea>
      <button class="gb-send" id="gbSend">Send ▶</button>
    </div>

  </aside>

  <!-- ── Right panel ───────────────────────────────────────── -->
  <section class="gb-right">

    <!-- Tech Tree + game.md panel (EXPLORE/LOAD/DESIGN phases) -->
    <div class="gb-design-panel" id="gbDesignPanel">
      <div class="gb-design-tabs">
        <button class="gb-design-tab active" data-tab="tree" id="gbTabTree">Tech Tree</button>
        <button class="gb-design-tab" data-tab="genre" id="gbTabGenre">Genre Guide</button>
        <button class="gb-design-tab" data-tab="gamemd" id="gbTabGameMd">game.md</button>
      </div>
      <div class="gb-design-tab-content" id="gbTabContentTree">
        <div class="gb-tech-tree" id="gbTechTree">
          <!-- Rendered by builder.js -->
        </div>
      </div>
      <div class="gb-design-tab-content" id="gbTabContentGenre" style="display:none">
        <div class="gb-genre-guide" id="gbGenreGuide">
          <canvas id="gbGenreExplorerCanvas" width="600" height="400"></canvas>
          <div class="gb-genre-guide-content" id="gbGenreGuideContent" style="display:none"></div>
          <div class="gb-genre-guide-edit" id="gbGenreGuideEdit" style="display:none">
            <textarea class="gb-genre-edit-area" id="gbGenreEditArea"></textarea>
            <button class="btn btn-primary" id="gbGenreSaveBtn">Save</button>
          </div>
          <div class="gb-genre-guide-toolbar" id="gbGenreGuideToolbar" style="display:none">
            <button class="btn btn-ghost btn-sm" id="gbGenreEditToggle">Edit</button>
          </div>
        </div>
      </div>
      <div class="gb-design-tab-content" id="gbTabContentGameMd" style="display:none">
        <pre class="gb-gamemd-preview" id="gbGameMdPreview">Design decisions will appear here as you chat...</pre>
      </div>
    </div>

    <!-- Live spec + early preview (DESIGN phase) -->
    <div class="gb-design-right" id="gbDesignRight" style="display:none">
      <div class="gb-spec-panel" id="gbSpecPanel">
        <div class="gb-spec-title">GAME SPEC</div>
        <div class="gb-spec-content" id="gbSpecContent">
          <div class="gb-spec-empty">Your game spec will appear here as you describe your idea...</div>
        </div>
      </div>
      <div class="gb-early-preview" id="gbEarlyPreview">
        <div class="gb-spec-title">EARLY PREVIEW</div>
        <div class="gb-preview-content" id="gbPreviewContent">
          <div class="gb-preview-placeholder">Preview generates after a few design details are set</div>
        </div>
      </div>
    </div>

    <!-- Concept art panel (VISUALIZE phase) -->
    <div class="gb-art-panel" id="gbArtPanel">
      <div style="font-size:0.65rem;letter-spacing:2px;color:var(--muted);text-transform:uppercase">Concept Art</div>
      <div class="gb-art-grid" id="gbArtGrid"></div>
      <div style="font-size:0.7rem;color:var(--muted)">Click an image to select it</div>
    </div>

    <!-- Generation progress panel (GENERATING phase) -->
    <div class="gb-progress-panel" id="gbProgressPanel">
      <div class="gb-progress-title">Building Your Game</div>

      <div id="gbProgressPct" class="gb-progress-pct">0%</div>

      <div class="gb-progress-bar-wrap">
        <div class="gb-progress-bar" id="gbProgressBar"></div>
      </div>

      <div id="gbProgressStep" class="gb-progress-step">Initializing…</div>

      <div class="gb-step-log" id="gbStepLog"></div>

      <div class="gb-eta" id="gbEta"></div>

      <div class="gb-stack-info" id="gbStackInfo">
        <div>Resolving tech stack…</div>
      </div>

      <div class="gb-console" id="gbConsole">
        <div class="gb-console-chrome">
          <span class="gb-dot red"></span>
          <span class="gb-dot yellow"></span>
          <span class="gb-dot green"></span>
          <span class="gb-console-title">build.log</span>
        </div>
        <div class="gb-console-body" id="gbConsoleBody"></div>
      </div>
    </div>

    <!-- Game panel (PLAYING phase) -->
    <div class="gb-game-panel" id="gbGamePanel">
      <div class="gb-game-toolbar">
        <span class="gb-game-title" id="gbGameTitle">—</span>
        <span class="gb-game-meta" id="gbGameMeta"></span>
        <div class="gb-toolbar-actions">
          <button class="gb-toolbar-btn" id="gbViewGameMd">game.md</button>
          <button class="gb-toolbar-btn" id="gbViewChatLog">chat log</button>
          <button class="gb-toolbar-btn" id="gbShareLink">share</button>
        </div>
      </div>
      <iframe class="gb-game-iframe" id="gbGameIframe" sandbox="allow-scripts allow-same-origin" title="Game Preview"></iframe>
    </div>

  </section>

</main>

<!-- ── Toast notifications ────────────────────────────────── -->
<div class="gb-toast-container" id="gbToastContainer"></div>

<script src="builder.js"></script>
</body>
</html>
