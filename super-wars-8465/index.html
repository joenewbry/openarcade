```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Neon Labyrinth</title>
    <style>
        :root {
            --bg: #0a0a0f;
            --accent: #00ffff;
            --player: #00ff00;
            --enemy: #ff0066;
            --text: #ffffff;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            touch-action: none;
        }
        #gameContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #gameContainer canvas {
            display: block;
        }
        #hud {
            position: absolute;
            top: 10px;
            left: 10px;
            pointer-events: none;
            z-index: 10;
        }
        .bar {
            width: 200px;
            height: 20px;
            background: rgba(0,0,0,0.7);
            border: 2px solid;
            margin-bottom: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        .bar-fill {
            height: 100%;
            transition: width 0.2s;
        }
        #healthBar {
            border-color: #ff3333;
        }
        #healthFill {
            background: linear-gradient(90deg, #ff3333, #ff6666);
            width: 100%;
        }
        #manaBar {
            border-color: #3366ff;
        }
        #manaFill {
            background: linear-gradient(90deg, #3366ff, #6699ff);
            width: 100%;
        }
        #score {
            font-size: 18px;
            text-shadow: 0 0 10px var(--accent);
            margin-top: 10px;
        }
        #spells {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .spell {
            width: 50px;
            height: 50px;
            border: 2px solid;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            background: rgba(0,0,0,0.7);
        }
        #fireSpell {
            border-color: #ff6600;
            box-shadow: 0 0 10px #ff6600;
        }
        #iceSpell {
            border-color: #00ffff;
            box-shadow: 0 0 10px #00ffff;
        }
        .cooldown-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            height: 0%;
            transition: height 0.1s;
        }
        #minimap {
            position: absolute;
            bottom: 10px;
            right: 10px;
            border: 2px solid var(--accent);
            border-radius: 4px;
            z-index: 10;
        }
        #minimapCanvas {
            display: block;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 15, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .overlay h1 {
            font-size: 48px;
            text-shadow: 0 0 20px var(--accent), 0 0 40px #ff00ff;
            margin-bottom: 20px;
        }
        .overlay p {
            font-size: 18px;
            margin-bottom: 10px;
            text-align: center;
            max-width: 400px;
        }
        .overlay button {
            margin-top: 20px;
            padding: 15px 40px;
            font-size: 20px;
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .overlay button:hover {
            background: var(--accent);
            color: var(--bg);
            box-shadow: 0 0 20px var(--accent);
        }
        #crosshair {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            pointer-events: none;
            z-index: 10;
        }
        #crosshair::before, #crosshair::after {
            content: '';
            position: absolute;
            background: rgba(255,255,255,0.7);
        }
        #crosshair::before {
            width: 2px;
            height: 20px;
            left: 9px;
            top: 0;
        }
        #crosshair::after {
            width: 20px;
            height: 2px;
            left: 0;
            top: 9px;
        }
        #mobileControls {
            display: none;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 20;
            pointer-events: none;
        }
        .joystick-area {
            position: absolute;
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            pointer-events: auto;
        }
        #moveJoystick {
            bottom: 20px;
            left: 20px;
        }
        #lookJoystick {
            bottom: 20px;
            right: 20px;
        }
        .joystick-knob {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(0,255,255,0.5);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .mobile-btn {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            pointer-events: auto;
            background: rgba(0,0,0,0.5);
        }
        #fireBtn {
            bottom: 80px;
            right: 160px;
            border-color: #ff6600;
            color: #ff6600;
        }
        #iceBtn {
            bottom: 160px;
            right: 100px;
            border-color: #00ffff;
            color: #00ffff;
        }
        @media (pointer: coarse) {
            #mobileControls {
                display: block;
            }
        }
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="hud">
            <div class="bar" id="healthBar">
                <div class="bar-fill" id="healthFill"></div>
            </div>
            <div class="bar" id="manaBar">
                <div class="bar-fill" id="manaFill"></div>
            </div>
            <div id="score">Score: 0</div>
            <div id="spells">
                <div class="spell" id="fireSpell">üî•<div class="cooldown-overlay" id="fireCooldown"></div></div>
                <div class="spell" id="iceSpell">‚ùÑÔ∏è<div class="cooldown-overlay" id="iceCooldown"></div></div>
            </div>
        </div>
        <div id="crosshair"></div>
        <div id="minimap">
            <canvas id="minimapCanvas" width="150" height="150"></canvas>
        </div>
        <div id="mobileControls">
            <div class="joystick-area" id="moveJoystick">
                <div class="joystick-knob" id="moveKnob"></div>
            </div>
            <div class="joystick-area" id="lookJoystick">
                <div class="joystick-knob" id="lookKnob"></div>
            </div>
            <div class="mobile-btn" id="fireBtn">üî•</div>
            <div class="mobile-btn" id="iceBtn">‚ùÑÔ∏è</div>
        </div>
    </div>

    <div class="overlay" id="startOverlay">
        <h1>Neon Labyrinth</h1>
        <p>Navigate the neon-lit dungeon, defeat enemies, and find the exit!</p>
        <p>Controls: WASD to move, Mouse to look</p>
        <p>Left-click: Fireball (AoE) | Right-click: Ice Shard (piercing)</p>
        <button id="startBtn">Enter the Labyrinth</button>
    </div>

    <div class="overlay hidden" id="overlay">
        <h1 id="overlayTitle">Game Over</h1>
        <p id="finalScore">Final Score: 0</p>
        <button id="restartBtn">Try Again</button>
    </div>

    <script>
        (function(){
            var timeout = setTimeout(function(){
                console.warn('Three.js CDN timeout, game may not work');
            }, 2000);
            var script = document.createElement('script');
            script.onload = function(){ clearTimeout(timeout); if(window.initGame) window.initGame(); };
            script.onerror = function(){ clearTimeout(timeout); console.error('Failed to load Three.js'); };
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js';
            document.head.appendChild(script);
        })();
    </script>

    <script>
        // Game state
        let scene, camera, renderer;
        let maze = [];
        let mazeSize = 15;
        let cellSize = 4;
        let wallHeight = 3;
        let player = { x: 1.5 * cellSize, z: 1.5 * cellSize, y: 1.5, health: 100, mana: 100 };
        let enemies = [];
        let projectiles = [];
        let particles = [];
        let torches = [];
        let score = 0;
        let gameRunning = false;
        let gamePaused = false;
        let keys = { w: false, a: false, s: false, d: false };
        let fireCooldown = 0;
        let iceCooldown = 0;
        let lastTime = 0;
        let mobileMove = { x: 0, z: 0 };
        let mobileLook = { x: 0, y: 0 };
        let exitPosition = null;
        let yaw = 0;
        let pitch = 0;

        // DOM elements
        const container = document.getElementById('gameContainer');
        const overlay = document.getElementById('overlay');
        const overlayTitle = document.getElementById('overlayTitle');
        const finalScoreEl = document.getElementById('finalScore');
        const restartBtn = document.getElementById('restartBtn');
        const startOverlay = document.getElementById('startOverlay');
        const startBtn = document.getElementById('startBtn');
        const healthFill = document.getElementById('healthFill');
        const manaFill = document.getElementById('manaFill');
        const scoreEl = document.getElementById('score');
        const minimapCanvas = document.getElementById('minimapCanvas');
        const minimapCtx = minimapCanvas.getContext('2d');
        const fireCooldownEl = document.getElementById('fireCooldown');
        const iceCooldownEl = document.getElementById('iceCooldown');

        // Audio context
        let audioCtx;
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            switch(type) {
                case 'fire':
                    osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
                    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.3);
                    break;
                case 'ice':
                    osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.2);
                    osc.type = 'triangle';
                    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.2);
                    break;
                case 'hit':
                    osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                    osc.type = 'sawtooth';
                    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.1);
                    break;
                case 'explosion':
                    osc.frequency.setValueAtTime(100, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(20, audioCtx.currentTime + 0.5);
                    osc.type = 'sawtooth';
                    gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.5);
                    break;
                case 'damage':
                    osc.frequency.setValueAtTime(300, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime